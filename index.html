
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Kun</title>
    <meta name="author" content="KunW" />
    <meta name="description" content="Make World Simple" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <link rel="icon" href="/images/nero.jpg" />
    <link rel="preconnect" href="https://cdn.staticfile.org" />
<script src="https://cdn.staticfile.org/vue/3.3.7/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.4.2/css/all.min.css" />
<link rel="preconnect" href="https://fonts.loli.net" />
<link rel="preconnect" href="https://gstatic.loli.net" crossorigin />
<link rel="stylesheet" href="https://fonts.loli.net/css2?family=Fira+Code:wght@400;500;600;700&family=Lexend:wght@400;500;600;700;800;900&family=Noto+Sans+SC:wght@400;500;600;700;800;900&display=swap" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.org/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdn.staticfile.org/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.org/highlight.js/11.9.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>



<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<link rel="stylesheet" href="/css/main.css" />

<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="layout">
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存 浏览器默认开启</p>
                    <img src="/images/loading.gif" />
                </div>
            </div>
        </transition>
        <div id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <nav id="desktop-menu">
        <a class="title" href="/">
            <span>KUN</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </nav>
    <nav id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;KUN</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </nav>
</div>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

        <div id="main" :class="loading ? 'into-enter-from': 'into-enter-active'">
            <div id="home-head">
    <div id="home-background" ref="homeBackground" data-images="/images/background.jpg"></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>Kun</h1>
                <h3>kun の blog</h3>
                <h5>Make World Simple</h5>
            </div>
        </span>
    </div>
</div>
<div id="home-posts-wrap" true ref="homePostsWrap">
    <div id="home-posts">
        

<div class="post">
    <a href="/2023/11/21/%E6%96%B0%E5%BB%BA%20%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3/">
        <h2 class="post-title">test</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/11/21
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <p>测试：</p>
<p>​	这是第二篇文章</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
        
    </div>
    <a href="/2023/11/21/%E6%96%B0%E5%BB%BA%20%E6%96%87%E6%9C%AC%E6%96%87%E6%A1%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/11/20/springframework-study/">
        <h2 class="post-title">springframework study</h2>
    </a>
    <div class="category-and-date">
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/11/20
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Spring-Framwork"><a href="#Spring-Framwork" class="headerlink" title="Spring Framwork"></a>Spring Framwork</h1><pre><code class="java">This is a study note.
</code></pre>
<h2 id="IoC（Inversion-of-Control）控制反转"><a href="#IoC（Inversion-of-Control）控制反转" class="headerlink" title="IoC（Inversion of Control）控制反转"></a>IoC（Inversion of Control）控制反转</h2><p>​		使用对象时，不主动new对象，而是由外部提供对象。</p>
<p>Bean：IoC容器中创建和初始化的对象。</p>
<h2 id="DI-Dependency-Injection-依赖注入"><a href="#DI-Dependency-Injection-依赖注入" class="headerlink" title="DI(Dependency Injection) 依赖注入"></a>DI(Dependency Injection) 依赖注入</h2><p>​		在容器中，建立bean与bean之间的依赖关系的过程。</p>
<h2 id="Bean实例化"><a href="#Bean实例化" class="headerlink" title="Bean实例化"></a>Bean实例化</h2><p>1.IoC容器调用对应类的无参构造器。</p>
<p>2.静态工厂实例化bean（factory-method属性）。</p>
<p>3.实例工厂实例化bean（先配置工厂对象的bean，然后配置产品对象bean中的factory-bean和factory-method）。</p>
<p>4.FactoryBean实例化对象。</p>
<h2 id="bean的生命周期"><a href="#bean的生命周期" class="headerlink" title="bean的生命周期"></a>bean的生命周期</h2><p>1.在IoC容器中给bean配置init(),destory()方法。如果想要看到destory的效果，可以调用ClassPathXmlApplicationContext.close()或者registerShutdowHook()方法。</p>
<p>2.实现类实现接口InitializingBean和DisposableBean。</p>
<h2 id="依赖注入方式"><a href="#依赖注入方式" class="headerlink" title="依赖注入方式"></a>依赖注入方式</h2><p>1.setter注入：在实现类中持有注入的对象，实现其set方法，然后在IoC容器中，给bean类添加property配置，若为引用类型的对象，则用name-ref；若为基础类型对象（int，String），则用name-value。</p>
<p>2.构造器注入：实现类中添加构造器，IoC容器配置Bean类中的constructor-arg属性。（name与构造器形参一致，可替换为type或者index降低耦合性）。</p>
<p>3.自动装配：autowire&#x3D;”byType”。只能用于装配引用类型依赖，不能对简单类型操作。且优先级</p>
<p>低于setter和构造器注入。 </p>
<h2 id="加载配置文件"><a href="#加载配置文件" class="headerlink" title="加载配置文件"></a>加载配置文件</h2><p>在IoC容器中，先开一个命名空间context，然后配置<context >其中建议location&#x3D;”classpath*:*properties” </p>
<h2 id="注解开发"><a href="#注解开发" class="headerlink" title="注解开发"></a>注解开发</h2><p>1.实现类中注解@Component，在IoC容器中配置<context component-scan>即组件扫描。</p>
<p>​		表现层bean：@Controller</p>
<p>​		业务层bean：@Service</p>
<p>​		数据层bean：@Repository</p>
<p>上面几种注解与Component作用一样，都是创建bean类，只是便于理解。</p>
<p>2.java配置类替换配置文件：Configer类中注解@Configuration声明其为配置类</p>
<p>​										注解@ComponentScan({“base package”})扫描bean组件。</p>
<p>App类中获取容器对象构造器变为AnnotationConfigApplicationContext(Configer.class)</p>
<p>3.@Scope(“singleton&#x2F;prototype”),bean类是否单例</p>
<p>​	@PostConstruct:在初始化bean方法上配置</p>
<p>​	@PreDestroy:在销毁bean方法上配置</p>
<p>！！注：spring只管理单例模式的bean类</p>
<ol start="4">
<li><p>@Autowired:自动装配，不需要写setter了，利用反射(例如Object o -&gt; this.o &#x3D; ioc.getBean(Object.class))直接装配。</p>
<p>通常配合@Qualifier(“bean_name”)使用来指定bean的名字。</p>
</li>
<li><p>@Value(“value”)配置普通类型的注入。</p>
</li>
<li><p>@PropertySource(“classpath:path”)，在配置类中注解，path为配置文件的路径（不允许通配符*）。</p>
</li>
<li><p>@Bean注解一个方法返回值为bean对象。</p>
</li>
<li><p>@Import(“configClass_name”)在配置类中注解，声明配置了其他的配置类。</p>
</li>
<li><p>第三方bean依赖注入：1.引用类型：方法形参 2.简单类型：成员变量</p>
</li>
</ol>
<h2 id="Spring整合mybatis"><a href="#Spring整合mybatis" class="headerlink" title="Spring整合mybatis"></a>Spring整合mybatis</h2><p>1.坐标mybatis-spring</p>
<p>2.MybatisConfig配置类，里面创建两个bean，一个是SqlSessionFactoryBean，一个是MapperScannerConfigurer</p>
<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><p>在不惊动原始设计的基础上对功能进行增强。核心为<strong>代理模式</strong>，spring容器扫描到与切入点匹配的bean后，创建这个bean对象的代理对象，然后后续都是对代理对象操作。</p>
<p>连接点：所有方法</p>
<p>切入点：需要增强功能的方法</p>
<p>通知：重复的代码</p>
<p>切面：通知+切入点</p>
<p>步骤：1.编写aop类，注解@Component交给IoC管理，注解@Aspect标识这是一个aop类</p>
<p>​			2.在类中编写空方法，注解@Pointcut（“execution（返回值 类全限定名.切入点方法名）”）</p>
<p>​				编写通知方法，注解@Before或者@After(“空方法”)</p>
<p>​			3.在配置类中注解@EnableAspectJAutoProxy，开启aop注解功能。</p>
<h2 id="AOP切入点表达式"><a href="#AOP切入点表达式" class="headerlink" title="AOP切入点表达式"></a>AOP切入点表达式</h2><p>通配符单个任意符号 *，多个连续任意符号 ..</p>
<h2 id="通知类型"><a href="#通知类型" class="headerlink" title="通知类型"></a>通知类型</h2><p>环绕通知：@Around，在方法形参中声明对象ProceedingJoinPoint pjp，在方法中在原始操作的位置pjp.proceed();如果原操作由返回值，那么要将通知返回值类型改为Object,并且将pjp.proceed()的值作为返回值。</p>
<h2 id="spring事务"><a href="#spring事务" class="headerlink" title="spring事务"></a>spring事务</h2><p>1.开启事务：@Transactional，写在接口或者方法上；</p>
<p>2.配置事务管理器PlatformTransaction类型的方法，参数传入datasource，调用DataSourceTransactionManager方法setDataSource,返回bean.</p>
<p>3.在配置类中注解@EnableTransactionManagement开启事务驱动。</p>
<h2 id="spring事务角色"><a href="#spring事务角色" class="headerlink" title="spring事务角色"></a>spring事务角色</h2><p>事务管理员：事务发起方，通常为业务层（service）开启事务的方法。</p>
<p>事务协调员：加入事务方，通常为数据层（dao）方法，也可以是业务层方法。</p>
<h2 id="spring事务属性"><a href="#spring事务属性" class="headerlink" title="spring事务属性"></a>spring事务属性</h2><p>事务回滚@Transaction（rollbackfor&#x3D;）等号后加入异常等行为，表示遇到这个行为就回滚事务。 </p>
<p>事务传播行为（使事务协调员不加入事务管理员，能新建一个事务）：在方法上注解@Transaction(Propagation&#x3D;)</p>
<h2 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h2><p>与servlet相同，为表现层开发（web框架，controller层）</p>
<h3 id="bean加载控制"><a href="#bean加载控制" class="headerlink" title="bean加载控制"></a>bean加载控制</h3><p>在@ComponentScan中设置excludeFilter或者只写需要加载bean的包。</p>
<h3 id="请求参数传递"><a href="#请求参数传递" class="headerlink" title="请求参数传递"></a>请求参数传递</h3><p>普通参数：在controller类方法形参中，使用@RequstParam注解可以给形参绑定请求参数。</p>
<p>实体类（pojo）参数：请求参数名要与实体类属性名一致。如果实体类中存在引用类型对象，在post&#x2F;get请求参数中写引用类型对象.引用类参数，例如book.bookname。</p>
<p>集合类参数：在controller接口的方法形参中注解@RequestParam可以将请求参数自动匹配并装入集合类对象中。</p>
<h3 id="日期格式参数传递"><a href="#日期格式参数传递" class="headerlink" title="日期格式参数传递"></a>日期格式参数传递</h3><p>在形参要传入日期类对象时，注解@DataTimeFormat（pattern&#x3D;”yyyy-MM-dd HH:mm:ss”）</p>
<p>将请求传入的字符串参数转换成Date类型底层由<strong>类型转换器</strong>convertor执行。</p>
<h3 id="响应"><a href="#响应" class="headerlink" title="响应"></a>响应</h3><p>@ResponseBody表示该方法的返回值直接写入http响应正文中，也就是return的东西会以json的格式响应回请求方，且该方法的返回值不会被解析为跳转路径，即该方法执行后不会跳转页面。</p>
<p>@RequestBody将http请求插入正文中，即将请求体写入对象中，这里将json格式的数组写入到了list对象中。</p>
<p>将传入的参数以json格式响应回去，由<strong>类型转换器</strong>HttpMessageConvertor执行。</p>
<h2 id="REST风格"><a href="#REST风格" class="headerlink" title="REST风格"></a>REST风格</h2><p>1.在RequestMapping中参数method&#x3D;RequestMethod.GET&#x2F;POST等，可以指定该方法对应什么请求方式，于是访问路径都将统一。</p>
<p>2.@PathVariable，注解在方法形参上，表示接收请求路径中的参数，并且在Mapping中路径上参数的位置给上大括号,如 {param}。</p>
<p>—–&gt;快速开发</p>
<p>1.类注解@RequestMapping(“&#x2F;paths”)，将paths作为上下文，注解@RestController(@Controller和@ResponseBody的结合体，即将类的bean交给spring管理，并且类中所有方法都返回json格式的响应)</p>
<p>2.在对应方法上注解@GetMapping &#x2F; @PostMapping &#x2F; @PutMapping &#x2F; @DeleteMapping</p>
<p><strong>当访问静态资源时404时</strong>，由于在mvc的配置类中，我们将所有的以”&#x2F;“开头的路径都交给了mvc处理，导致在地址栏输入静态资源的路径时，无法获取-&gt;设置一个新配置类MvcConfigSurpport继承WebMvcConfigurationSupport类，实现方法addResourceHandlers(ResourceHandlerRegistry registry)。</p>
<h2 id="表现层数据封装"><a href="#表现层数据封装" class="headerlink" title="表现层数据封装"></a>表现层数据封装</h2><p>1.设置统一数据返回结果类（类中属性可以例如：data,code,msg等）。</p>
<h2 id="springmvc提供的异常处理器"><a href="#springmvc提供的异常处理器" class="headerlink" title="springmvc提供的异常处理器"></a>springmvc提供的异常处理器</h2><p>在表现层新建类，注解@RestControllerAdvice，声明方法处理接收到的异常，并注解@ExceptionHandler(Exception.class)</p>
<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><p>1.业务异常		2.系统异常		3.其他异常</p>
<p>处理方法：自定义异常类，继承RuntimeException</p>
<p>​					拦截并处理异常：自定义异常处理类，注解@RestControllerAdvice,在方法上注解@ExceptionHandler(ExceptionClass.class).</p>
<h3 id="前后端联调图书管理系统"><a href="#前后端联调图书管理系统" class="headerlink" title="前后端联调图书管理系统"></a>前后端联调图书管理系统</h3><p>自己操作一遍</p>
<h2 id="拦截器-Interceptor"><a href="#拦截器-Interceptor" class="headerlink" title="拦截器(Interceptor)"></a>拦截器(Interceptor)</h2><p>动态拦截方法调用，作用：1.在指定方法调用前后执行预定的代码。</p>
<p>​											2.阻止原方法的执行。</p>
<p><code>拦截器仅针对SpringMvc的访问，拦截器对所有的servlet访问进行增强</code></p>
<p>布置拦截器步骤：1. 自定义拦截器类，继承接口<code>HandlerInterceptor</code>,可选择的覆写其中的方法。</p>
<p>​								2.类注解<code>@Component</code>,在springmvc的配置类中扫描该类包。</p>
<p>​								3.在控制springmvc不能处理哪些请求的类MvcSupport中，自动装配一个拦截器类对象             								 bean，覆写方法<code>addInterceptor</code>.</p>
<p><strong>在拦截器类中的方法<code>preHandler</code>中，如果返回值return false;那么拦截该请求，反之，return true；放行，并进行一些前后的处理，并且preHandler方法无论访问放不放行必定会执行</strong></p>
<p>简化拦截器配置（侵入性较强）：直接在springmvc的配置类中实现接口<code>WebMvcConfigurer</code>,覆写<code>addInterceptors</code>方法,可在其中添加多个拦截器。</p>
<h2 id="拦截器参数"><a href="#拦截器参数" class="headerlink" title="拦截器参数"></a>拦截器参数</h2><p>1.request和response跟servlet中的过滤器差不多，handler对象为执行这个访问的方法的封装，可以利用反射机制来对这个handler进行处理，例如：强制类型转换为HandlerMethod类型，然后调用这个方法。</p>
<p>2.modelAndView参数是springmvc关于页面跳转的参数。</p>
<p>3.ex参数可以拿到访问执行过程中的异常。</p>
<h2 id="SpringSecurity"><a href="#SpringSecurity" class="headerlink" title="SpringSecurity"></a>SpringSecurity</h2><p>核心为过滤器链：</p>
<p>UsernamePasswordAuthenticationFilter:处理登录界面填写的用户名密码后的请求。</p>
<p><strong>ExceptionTranslationFilter：</strong> 处理过滤器链中抛出的任何AccessDeniedException和AuthenticationException 。</p>
<p><strong>FilterSecurityInterceptor：</strong> 负责权限校验的过滤器。</p>
<p>Authentication接口: 它的实现类，表示当前访问系统的用户，封装了用户相关信息。</p>
<p>AuthenticationManager接口：定义了认证Authentication的方法</p>
<p>UserDetailsService接口：加载用户特定数据的核心接口。里面定义了一个根据用户名查询用户信息的方法。</p>
<p>UserDetails接口：提供核心用户信息。通过UserDetailsService根据用户名获取处理的用户信息要封装成UserDetails对象返回。然后将这些信息封装到Authentication对象中。</p>
<p><strong>核心步骤</strong>：1.实现security提供的UseDetailService接口，返回一个UserDetail实现类的对象。</p>
<p>​				   2.配置类SecurityConfig继承WebSecurityConfigurerAdapt类，修改密码加密算法为BCryptPasswordEncoder，和AuthenticationManager一并封装成bean注入容器。</p>
<p>​				   3.具体登录业务实现类验证登录是否正确，如果正确，根据userId生成token存入redis缓存。</p>
<p>​				   4.自定义认证过滤器（extends OncePerRequestFilter），获取请求头中的token，解析出其中的userId。注入配置类SecurityConfig中，添加该过滤器到过滤器链中。</p>
<p>​					5.退出登录只需定义一个方法，获取SecurityContextHodler中的认证信息，删除redis中对应的数据。</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
        
    </div>
    <a href="/2023/11/20/springframework-study/" class="go-post">阅读全文</a>
</div>


        <div class="page-current">
    
    <span class="current">1</span>
    
    
    
    
</div>

    </div>
    
    <div id="home-card">
        <div id="card-style">
    <div id="card-div">
        <div class="avatar">
            <img src="/images/nero.jpg" alt="avatar" />
        </div>
        <div class="name">KunW</div>
        <div class="description">
            <p>Description<br>…</p>

        </div>
        
        
        <div class="friend-links">
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://argvchs.github.io">Argvchs</a>
            </div>
            
        </div>
        
    </div>
</div>

    </div>
    
</div>

            <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2023 Kun
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;KunW
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

        </div>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/js/main.js"></script>
    
</body>
</html>
